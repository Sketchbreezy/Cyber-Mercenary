import asyncio
import logging
from pathlib import Path
from config import Settings
from jobs.scanner_job import ScannerJob

logger = logging.getLogger(__name__)
logging.basicConfig(level=logging.INFO)

class CyberMercenary:
    """Main agent class"""
    def __init__(self, config: Settings):
        self.config = config
        self.scanner = self  # Temporary stub; replace with real scanner if available

    # Stub functions for demonstration
    def get_block_number(self):
        return 123456

    async def scan_recent_contracts(self, limit=100):
        return [f"contract_{i}" for i in range(limit)]


async def main():
    # Load configuration from .env
    env_path = Path(__file__).parent.parent / ".env"
    if not env_path.exists():
        raise FileNotFoundError(f".env file not found at {env_path}")

    config = Settings()  # Make sure your .env values match Settings fields

    # Create agent
    agent = CyberMercenary(config)

    # Start scanner job
    scanner_job = ScannerJob(agent, config)
    await scanner_job.run()


if __name__ == "__main__":
    asyncio.run(main())
